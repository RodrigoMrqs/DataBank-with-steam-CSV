CREATE TABLE games(
	app_id INT PRIMARY KEY,
	name TEXT,
	release_date TEXT NOT NULL,
	required_age smallint NOT NULL,
	price decimal(5,2) NOT NULL,
	discount INT NOT NULL,
	dlc_count INT NOT NULL,
	about_the_game TEXT,
	website TEXT,
	header_image TEXT,
	support_url TEXT,
	support_email TEXT
);

CREATE TABLE game_metrics(
	app_id INT,
	estimated_owners TEXT NOT NULL,
	peak_ccu INT NOT NULL,
	reviews TEXT,
	metacritic_score INT NOT NULL,
	metacritic_url TEXT,
	user_score INT NOT NULL,
	positive INT NOT NULL,
	negative INT NOT NULL,
	score_rank decimal(4,1),
	acheivements INT NOT NULL,
	recomendations INT NOT NULL,
	avarege_palytime_forever INT NOT NULL,
	avarege_playtime_two_weeks INT NOT NULL,
	media_playtime_forever INT NOT NULL,
	median_playtime_two_weeks INT NOT NULL,
	CONSTRAINT fk_game_metrics_games
		FOREIGN KEY (app_id) REFERENCES games(app_id),
	PRIMARY KEY(app_id)
);

CREATE TABLE plataforms(
	app_id INT,
	windows boolean NOT NULL,
	mac boolean NOT NULL,
	linux boolean NOT NULL,
	CONSTRAINT fk_plataforms_games
		FOREIGN KEY (app_id) REFERENCES games(app_id),
	PRIMARY KEY (app_id)
);

CREATE TABLE supported_languages(
	id SERIAL PRIMARY KEY,
	supported_languages TEXT NOT NULL
);

CREATE TABLE supported_languages_games(
	id_supported_language INT,
	app_id_game INT,
	CONSTRAINT fk_languages
		FOREIGN KEY (id_supported_language) REFERENCES supported_languages(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_supported_language, app_id_game)
);

CREATE TABLE full_audio_languages(
	id SERIAL PRIMARY KEY,
	full_audio_languages TEXT NOT NULL
);

CREATE TABLE full_audio_languages_games(
	id_full_audio_language INT,
	app_id_game INT,
	CONSTRAINT fk_languages
		FOREIGN KEY (id_full_audio_language) REFERENCES full_audio_languages(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_full_audio_language, app_id_game)
);

CREATE TABLE developers(
	id SERIAL PRIMARY KEY,
	developers TEXT
);

CREATE TABLE developers_games(
	id_developers INT,
	app_id_game INT,
	CONSTRAINT fk_developers
		FOREIGN KEY(id_developers) REFERENCES developers(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY(id_developers, app_id_game)
);

CREATE TABLE publishers(
	id SERIAL PRIMARY KEY,
	publishers TEXT
);

CREATE TABLE publishers_games(
	id_publishers INT,
	app_id_game INT,
	CONSTRAINT fk_publishers
		FOREIGN KEY (id_publishers) REFERENCES publishers(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_publishers, app_id_game)
);

CREATE TABLE categories(
	id SERIAL PRIMARY KEY,
	categories TEXT
);

CREATE TABLE categories_games(
	id_categorie INT,
	app_id_game INT,
	CONSTRAINT fk_categories
		FOREIGN KEY (id_categorie) REFERENCES categories(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_categorie, app_id_game)
);

CREATE TABLE genres(
	id SERIAL PRIMARY KEY,
	genres TEXT
);

CREATE TABLE genres_games(
	id_genres INT,
	app_id_game INT,
	CONSTRAINT fk_genres
		FOREIGN KEY (id_genres) REFERENCES genres(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_genres, app_id_game)
);

CREATE TABLE tags(
	id SERIAL PRIMARY KEY,
	tags TEXT
);

CREATE TABLE tags_games(
	id_tag INT,
	app_id_game INT,
	CONSTRAINT fk_tags
		FOREIGN KEY (id_tag) REFERENCES tags(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_tag, app_id_game)
);

CREATE TABLE screenshots(
	id SERIAL PRIMARY KEY,
	screenshots TEXT
);

CREATE TABLE screenshots_games(
	id_screenshot INT,
	app_id_game INT,
	CONSTRAINT fk_screenshots
		FOREIGN KEY (id_screenshot) REFERENCES screenshots(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_screenshot, app_id_game)
);

CREATE TABLE movies(
	id SERIAL PRIMARY KEY,
	movies TEXT
);

CREATE TABLE movies_games(
	id_movie INT,
	app_id_game INT,
	CONSTRAINT fk_movies
		FOREIGN KEY (id_movie) REFERENCES movies(id),
	CONSTRAINT fk_games
		FOREIGN KEY (app_id_game) REFERENCES games(app_id),
	PRIMARY KEY (id_movie, app_id_game)
);

